# 此文档由AI生成，部分内容可能存在不准确或错误，敬请谅解。
# Sai2Capture - SAI2 视频录制工具

一个专为 SAI2（日本著名绘画软件）用户设计的窗口内容录制工具，能够自动捕获窗口变化并生成高质量视频文件。

## 🆕 最近更新

### v1.1 (2026-02-07)

- 🪟 **窗口布局记忆** - 新增窗口大小和位置的自动保存与恢复功能，下次启动时保留用户界面设置
- 🎨 **界面优化** - 调整主窗口默认尺寸（800x600），优化按钮布局提升用户体验
- 🔧 **功能修复** - 修复日志过滤功能，确保日志级别筛选正常工作

## ✨ 主要特性

- 🎯 **智能窗口捕获** - 自动检测并录制指定窗口的内容变化
- 🎬 **高效压缩录制** - 只在内容发生变化时才捕获帧，大幅减少文件体积
- ⏸️ **暂停与继续** - 支持录制过程中暂停和继续，方便分段创作
- 🔧 **灵活配置** - 可自定义捕获间隔、窗口选择、缩放级别等参数
- 🔥 **全局热键** - 支持全局快捷键操作，无需切换窗口
- 🎵 **操作反馈** - 丰富的音效和视觉反馈，操作状态一目了然
- 📱 **美观界面** - 现代化的 WPF 界面设计，简洁易用

## 🚀 快速开始

### 系统要求

- Windows 10/11 (版本 19041 或更高)
- 64 位操作系统
- 无需安装 .NET Runtime（自包含发布）

### 安装步骤

1. 从 [Releases](../../releases) 页面下载最新版本的安装包
2. 解压到任意文件夹
3. 运行 `Sai2Capture.exe`

### 基本使用

1. **启动应用** - 打开 Sai2Capture
2. **选择目标窗口** - 在"窗口名称"下拉框中选择要录制的 SAI2 窗口
3. **调整设置** - 根据需要调整捕获间隔、视频质量等参数
4. **开始录制** - 点击"开始捕获"按钮或使用快捷键 开始录制
5. **控制录制** - 可随时暂停、继续或停止录制
6. **保存视频** - 停止录制后，视频文件会自动保存到指定文件夹

## 🎮 操作指南

### 主界面功能

- **主页面** - 核心录制控制和状态显示，优化了按钮布局
  - 主要控制按钮（开始/继续、暂停、停止录制）位于第一行
  - 辅助功能按钮（预览窗口、打开保存目录等）位于第二行
- **设置** - 详细的参数配置和热键管理
- **系统日志** - 实时查看操作记录和错误信息，支持日志级别过滤

### 录制控制

- **开始捕获** - 开始监控窗口变化并准备录制
- **暂停捕获** - 暂停录制（保留已捕获内容）
- **停止捕获** - 停止录制并生成视频文件

### 界面特性

- **窗口记忆** - 自动保存窗口大小和位置，下次启动时恢复用户的界面设置
- **响应式布局** - 优化的窗口尺寸（默认800x600）和按钮排列方式

### 热键操作

默认快捷键（可在设置中自定义）：
- `F9` - 开始捕获
- `F11` - 停止捕获
- `F10` - 暂停/继续捕获

## 🛠️ 技术架构

### 核心技术

- **框架**: .NET 8.0 + WPF/WindowsForms
- **图像处理**: OpenCV 4.8.0
- **窗口捕获**: Windows PrintWindow API
- **视频编码**: OpenCV VideoWriter
- **依赖注入**: Microsoft.Extensions.DependencyInjection
- **MVVM框架**: CommunityToolkit.Mvvm
- **UI库**: WPF-UI
- **设置管理**: 基于JSON的配置持久化，支持窗口状态记忆

### 性能特点

- **启动速度**: 快速启动，无需配置复杂环境
- **内存占用**: 合理的内存使用，适合长时间运行
- **CPU 效率**: 智能帧差检测，仅在内容变化时处理
- **兼容性**: 优秀的系统兼容性，支持 Windows 10/11

## 💡 使用技巧

1. **优化性能** - 调整捕获间隔，较低值提供更流畅的效果但文件更大
2. **预览窗口** - 使用预览功能确保选择了正确的窗口
3. **批量处理** - 设置完成后可重复使用相同的配置
4. **故障排除** - 查看系统日志了解详细错误信息

## 🔧 开发说明

### 构建环境

- Visual Studio 2022 或更高版本
- .NET 8.0 SDK
- Windows 10/11 SDK

### 构建命令

```bash
# 开发构建
dotnet build

# 发布单文件版本
dotnet publish -c Release -r win-x64 --self-contained true /p:PublishSingleFile=true

# 包含详细日志的构建
dotnet build --verbosity detailed
```

### 项目结构

```
Sai2Capture/
├── Services/                 # 核心服务层
│   ├── WindowCaptureService  # 窗口捕获服务
│   ├── CaptureService        # 录制控制服务
│   ├── LogService           # 日志服务
│   └── ...
├── ViewModels/              # MVVM视图模型
├── Views/                   # UI视图
├── Converters/              # 数据转换器
├── Models/                  # 数据模型
├── Commands/                # 命令定义
└── Resources/               # 资源文件
    └── Sounds/              # 声音文件（嵌入式）
```

## 🤝 反馈与建议

如果您在使用过程中遇到问题或有改进建议，欢迎通过以下方式反馈：
- 提交 [Issue](../../issues)
- 发送邮件至开发团队
- 在讨论区分享使用经验

## 📄 许可证

本项目采用 MIT 许可证，详情请参阅 [LICENSE](LICENSE) 文件。

---

**享受您的创作之旅！** 🎨✨
