<Window x:Class="Sai2Capture.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Sai2Capture"
        xmlns:converters="clr-namespace:Sai2Capture.Converters"
        mc:Ignorable="d"
        Title="Sai2 捕获工具" 
        Height="350" 
        Width="800"
        Closing="Window_Closing">
    <Window.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 窗口选择 -->
        <TextBlock Grid.Row="0" Grid.Column="0" Text="窗口名称:" Margin="5" VerticalAlignment="Center"/>
        <ComboBox Grid.Row="0" Grid.Column="1" 
                  ItemsSource="{Binding WindowTitles}"
                  SelectedItem="{Binding SelectedWindowTitle}"
                  Margin="5" IsEnabled="{Binding UseComboBox}"/>
        <CheckBox Grid.Row="0" Grid.Column="2" 
                  Content="使用下拉列表中的窗口"
                  VerticalAlignment="Center"
                  Margin="5"
                  IsChecked="{Binding UseComboBox}"/>
        <TextBox Grid.Row="0" Grid.Column="3" 
                 Text="{Binding WindowName}"
                 Margin="5" IsEnabled="{Binding UseComboBox, Converter={StaticResource InverseBooleanConverter}}"/>

        <!-- 捕获间隔 -->
        <TextBlock Grid.Row="1" Grid.Column="0" Text="捕获时间间隔(秒):" Margin="5" VerticalAlignment="Center"/>
        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding CaptureInterval}" Margin="5"/>

        <!-- 缩放比例 -->
        <TextBlock Grid.Row="2" Grid.Column="0" Text="缩放大小:" Margin="5" VerticalAlignment="Center"/>
        <ComboBox Grid.Row="2" Grid.Column="1" 
                  SelectedItem="{Binding ZoomLevel}"
                  Margin="5">
            <ComboBoxItem Content="100%"/>
            <ComboBoxItem Content="125%"/>
            <ComboBoxItem Content="150%"/>
            <ComboBoxItem Content="200%"/>
        </ComboBox>

        <!-- 视频时长 -->
        <TextBlock Grid.Row="3" Grid.Column="0" Text="视频时长(秒):" Margin="5" VerticalAlignment="Center"/>
        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding VideoDuration}" Margin="5"/>

        <!-- 状态显示 -->
        <TextBlock Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4" 
                   Text="{Binding CaptureService.Status}" 
                   Margin="5" FontWeight="Bold"/>
        
        <!-- 控制按钮 -->
        <StackPanel Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4" 
                   Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Content="开始/继续" Command="{Binding StartCaptureCommand}" 
                   Width="100" Margin="5"/>
            <Button Content="暂停" Command="{Binding PauseCaptureCommand}" 
                   Width="100" Margin="5"/>
            <Button Content="停止录制" Command="{Binding StopCaptureCommand}" 
                   Width="100" Margin="5"/>
        </StackPanel>

        <!-- 功能按钮 -->
        <StackPanel Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="4" 
                   Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Content="置顶" 
                   Command="{Binding ToggleTopmostCommand}" 
                   CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" 
                   Width="100" Margin="5"/>
            <Button Content="生成视频" Command="{Binding CreateVideoCommand}" 
                   Width="100" Margin="5"/>
            <Button Content="预览窗口" Command="{Binding PreviewWindowCommand}" 
                   Width="100" Margin="5"/>
        </StackPanel>
    </Grid>
</Window>
